{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/2022-08-10-sql-subquery/",
    "result": {"data":{"site":{"siteMetadata":{"title":"pushing the boundary","siteUrl":"https://tkhwang.me","thumbnail":"/thumbnails/main.png"}},"markdownRemark":{"id":"09313776-aca6-5b5b-9701-d774705116c3","tableOfContents":"<ul>\n<li>\n<p><a href=\"#noncorrelated-subqueries\">Noncorrelated Subqueries</a></p>\n<ul>\n<li>\n<p><a href=\"#single-row-with-a-single-column\">Single row with a single column</a></p>\n</li>\n<li>\n<p><a href=\"#multiple-rows-with-a-single-column\">Multiple rows with a single column</a></p>\n<ul>\n<li><a href=\"#in--not-in\"><code class=\"language-text\">in</code> , <code class=\"language-text\">not in</code></a></li>\n<li><a href=\"#all\"><code class=\"language-text\">all</code></a></li>\n<li><a href=\"#any\"><code class=\"language-text\">any</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#multiple-rows-with-columns\">Multiple rows with columns</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#correlated-subqueries\">Correlated Subqueries</a></p>\n</li>\n<li>\n<p><a href=\"#subquery%EB%A5%BC-%EC%96%B8%EC%A0%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80-\">SubQuery를 언제 사용하는가 ?</a></p>\n<ul>\n<li>\n<p><a href=\"#subquery-as-data-sources\">subquery as data sources</a></p>\n<ul>\n<li><a href=\"#data-fabrication\">Data fabrication</a></li>\n<li><a href=\"#task-oriented-subqueries\">Task-oriented subqueries</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#subquery-in-filter-conditions\">subquery in filter conditions</a></p>\n</li>\n<li>\n<p><a href=\"#subquery-as-expression-generators\">subquery as expression generators</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#references\">References</a></p>\n</li>\n</ul>","excerpt":"SQL Subquery 관련된 내용 정리. Noncorrelated Subqueries subquery를 포함하는 containing statement를 조회하지 않는 subquery. Single row with a single column equality condition…","html":"<p>SQL Subquery 관련된 내용 정리.</p>\n<h2 id=\"noncorrelated-subqueries\" style=\"position:relative;\">Noncorrelated Subqueries<a href=\"#noncorrelated-subqueries\" aria-label=\"noncorrelated subqueries permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>subquery를 포함하는 containing statement를 조회하지 않는 subquery.</p>\n<h3 id=\"single-row-with-a-single-column\" style=\"position:relative;\">Single row with a single column<a href=\"#single-row-with-a-single-column\" aria-label=\"single row with a single column permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>equality condition (<code class=\"language-text\">=</code>, <code class=\"language-text\">&lt;></code>) 에서 사용함.</li>\n<li>만약 단일 값이 아니라면 에러 발생함.</li>\n</ul>\n<h3 id=\"multiple-rows-with-a-single-column\" style=\"position:relative;\">Multiple rows with a single column<a href=\"#multiple-rows-with-a-single-column\" aria-label=\"multiple rows with a single column permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4 id=\"in--not-in\" style=\"position:relative;\"><code class=\"language-text\">in</code> , <code class=\"language-text\">not in</code><a href=\"#in--not-in\" aria-label=\"in  not in permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>single value가 set of values 안에 포함되는지 여부를 확인할 수 있음.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Supervisor 조회</span>\n<span class=\"token keyword\">SELECT</span> emp_id<span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">,</span> lname<span class=\"token punctuation\">,</span> title\n<span class=\"token keyword\">FROM</span> employee\n<span class=\"token keyword\">WHERE</span> emp_id <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span> superior_emp_id\n    <span class=\"token keyword\">FROM</span> employee\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"all\" style=\"position:relative;\"><code class=\"language-text\">all</code><a href=\"#all\" aria-label=\"all permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>single value 와  set 만의 모든 값 과의 비교함.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token comment\">-- Supervisor가 아닌 employee 모두 조회</span>\n<span class=\"token keyword\">SELECT</span> emp_id<span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">,</span> lname<span class=\"token punctuation\">,</span> title\n<span class=\"token keyword\">FROM</span> employee\n<span class=\"token keyword\">WHERE</span> emp_id <span class=\"token operator\">&lt;></span> <span class=\"token keyword\">ALL</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span> superior_emp_id\n    <span class=\"token keyword\">FROM</span> employee\n    <span class=\"token keyword\">WHERE</span> superior_emp_id <span class=\"token operator\">IS</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"any\" style=\"position:relative;\"><code class=\"language-text\">any</code><a href=\"#any\" aria-label=\"any permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<p>single comparison이 만족하면 true 가 됨.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> account_id<span class=\"token punctuation\">,</span> cust_id<span class=\"token punctuation\">,</span> product_id<span class=\"token punctuation\">,</span> avail_balance\n<span class=\"token keyword\">FROM</span> account\n<span class=\"token keyword\">WHERE</span> avail_balance <span class=\"token operator\">></span> <span class=\"token keyword\">ANY</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span> a<span class=\"token punctuation\">.</span>avail_balance\n    <span class=\"token keyword\">FROM</span> account a\n    <span class=\"token keyword\">INNER</span> <span class=\"token keyword\">JOIN</span> individual i\n    <span class=\"token keyword\">ON</span> a<span class=\"token punctuation\">.</span>cust_id <span class=\"token operator\">=</span> i<span class=\"token punctuation\">.</span>cust_id\n    <span class=\"token keyword\">WHERE</span> i<span class=\"token punctuation\">.</span>fname <span class=\"token operator\">=</span> <span class=\"token string\">'Frank'</span> <span class=\"token operator\">AND</span> i<span class=\"token punctuation\">.</span>lname <span class=\"token operator\">=</span> <span class=\"token string\">'Tucker'</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"multiple-rows-with-columns\" style=\"position:relative;\">Multiple rows with columns<a href=\"#multiple-rows-with-columns\" aria-label=\"multiple rows with columns permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h2 id=\"correlated-subqueries\" style=\"position:relative;\">Correlated Subqueries<a href=\"#correlated-subqueries\" aria-label=\"correlated subqueries permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>containing statement가 subquery를 하나 이상의 컬럼을 참조하는 경우</li>\n<li>containing statement가 <strong>각 row에 대해서 subquery를 한번씩 실행함</strong>.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> c<span class=\"token punctuation\">.</span>cust_id<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>cust_type_cd<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>city\n<span class=\"token keyword\">FROM</span> customer c\n<span class=\"token keyword\">WHERE</span> <span class=\"token number\">2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">FROM</span> account a\n    <span class=\"token keyword\">WHERE</span> a<span class=\"token punctuation\">.</span>cust_id <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>cust_id\n<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">exists</code> operator : 양과는 무관하게 관계가 있는 확인하기 위하여 사용함.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> a<span class=\"token punctuation\">.</span>account_id<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">.</span>product_cd<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">.</span>cust_id<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">.</span>avail_balance\n<span class=\"token keyword\">FROM</span> account a\n<span class=\"token keyword\">WHERE</span> <span class=\"token keyword\">EXISTS</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">FROM</span> <span class=\"token keyword\">transaction</span> t\n    <span class=\"token keyword\">WHERE</span> t<span class=\"token punctuation\">.</span>account_id <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>account_id <span class=\"token operator\">AND</span> t<span class=\"token punctuation\">.</span>txn_date <span class=\"token operator\">=</span> <span class=\"token string\">'2008-09-22'</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"subquery를-언제-사용하는가-\" style=\"position:relative;\">SubQuery를 언제 사용하는가 ?<a href=\"#subquery%EB%A5%BC-%EC%96%B8%EC%A0%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80-\" aria-label=\"subquery를 언제 사용하는가  permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"subquery-as-data-sources\" style=\"position:relative;\">subquery as data sources<a href=\"#subquery-as-data-sources\" aria-label=\"subquery as data sources permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li><code class=\"language-text\">from</code> 절에 table 처럼 사용할 수 있음.</li>\n<li><code class=\"language-text\">from</code> 절에 사용된 subquery는 반드시 <strong>non-correlated 이어야 함.</strong></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> d<span class=\"token punctuation\">.</span>dept_id<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> e_cnt<span class=\"token punctuation\">.</span>how_many<span class=\"token punctuation\">,</span> num_employees\n<span class=\"token keyword\">FROM</span> department d\n<span class=\"token keyword\">INNER</span> <span class=\"token keyword\">JOIN</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span>\n        dept_id<span class=\"token punctuation\">,</span>\n        <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> how_many\n    <span class=\"token keyword\">FROM</span> employee\n    <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> dept_id\n<span class=\"token punctuation\">)</span> e_cnt\n<span class=\"token keyword\">ON</span> d<span class=\"token punctuation\">.</span>dept_id <span class=\"token operator\">=</span> e_cnt<span class=\"token punctuation\">.</span>dept_id</code></pre></div>\n<h4 id=\"data-fabrication\" style=\"position:relative;\">Data fabrication<a href=\"#data-fabrication\" aria-label=\"data fabrication permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<h4 id=\"task-oriented-subqueries\" style=\"position:relative;\">Task-oriented subqueries<a href=\"#task-oriented-subqueries\" aria-label=\"task oriented subqueries permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<h3 id=\"subquery-in-filter-conditions\" style=\"position:relative;\">subquery in filter conditions<a href=\"#subquery-in-filter-conditions\" aria-label=\"subquery in filter conditions permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li><code class=\"language-text\">group by</code> 절은 <code class=\"language-text\">where</code> 절 뒤에 evaluate 되기 때문에 조건을 <code class=\"language-text\">where</code> 절에 사용할 수 있고, 대신 <code class=\"language-text\">having</code> 절에 사용해야 함.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span>\n    open_emp_id<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> how_many\n<span class=\"token keyword\">FROM</span> account\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> open_emp_id\n<span class=\"token keyword\">HAVING</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">SELECT</span> <span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>emp_cnt<span class=\"token punctuation\">.</span>how_many<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> how_many\n        <span class=\"token keyword\">FROM</span> account\n        <span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> open_emp_id\n    <span class=\"token punctuation\">)</span> emp_cnt\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"subquery-as-expression-generators\" style=\"position:relative;\">subquery as expression generators<a href=\"#subquery-as-expression-generators\" aria-label=\"subquery as expression generators permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li><code class=\"language-text\">single-column, single-row scalar subquery</code>는 expression으로 다음에 사용될 수 있음.\n<ul>\n<li><code class=\"language-text\">select</code></li>\n<li><code class=\"language-text\">order by</code></li>\n<li><code class=\"language-text\">insert</code> 절의 values</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span>\n    <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">SELECT</span> p<span class=\"token punctuation\">.</span>name\n        <span class=\"token keyword\">FROM</span> product p\n        <span class=\"token keyword\">WHERE</span> p<span class=\"token punctuation\">.</span>product_cd <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>product_cd <span class=\"token operator\">AND</span> p<span class=\"token punctuation\">.</span>product_type_cd <span class=\"token operator\">=</span> <span class=\"token string\">'ACCOUNT'</span>\n    <span class=\"token punctuation\">)</span> product<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">SELECT</span> b<span class=\"token punctuation\">.</span>name\n        <span class=\"token keyword\">FROM</span> branch b\n        <span class=\"token keyword\">WHERE</span> b<span class=\"token punctuation\">.</span>branch_id <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>open_branch_id\n    <span class=\"token punctuation\">)</span> branch\n    <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">SELECT</span> CONCAT<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>fname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>lname<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">FROM</span> employee e\n        <span class=\"token keyword\">WHERE</span> e<span class=\"token punctuation\">.</span>emp_id <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>open_emp_id\n    <span class=\"token punctuation\">)</span> name<span class=\"token punctuation\">,</span>\n    <span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>avail_balance<span class=\"token punctuation\">)</span> tot_deposits\n<span class=\"token keyword\">FROM</span> account a\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> a<span class=\"token punctuation\">.</span>product_cd<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">.</span>open_branch_id<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">.</span>open_emp_id\n<span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"references\" style=\"position:relative;\">References<a href=\"#references\" aria-label=\"references permalink\" class=\"heading-anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li><a href=\"https://www.amazon.com/Learning-SQL-Master-Fundamentals/dp/0596520832/ref=sr_1_2?crid=24PT9JGBW8CX1&#x26;keywords=learning+sql&#x26;qid=1660790197&#x26;sprefix=learning+sq%2Caps%2C285&#x26;sr=8-2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Learning SQL: Master SQL Fundamentals: Beaulieu, Alan: 0636920520832: Amazon.com: Books</a></li>\n</ul>","fields":{"slug":"/2022-08-10-sql-subquery/"},"frontmatter":{"title":"SQL: Subquery","date":"2022-08-10","description":"SQL 중에서 Subquery 관련 내용 정리","tags":["sql","subquery"],"thumbnail":null}},"previous":{"fields":{"slug":"/2022-08-09-sql-join/"},"frontmatter":{"title":"SQL: Join"}},"next":{"fields":{"slug":"/2022-08-10-sql-group/"},"frontmatter":{"title":"SQL: Group"}}},"pageContext":{"id":"09313776-aca6-5b5b-9701-d774705116c3","previousPostId":"6406efc0-0907-5ebf-9e4a-1713a6ec6acf","nextPostId":"042afa35-b23c-5dbb-8543-3579f647c52b"}},
    "staticQueryHashes": ["2260143708","658623446","984448874"]}